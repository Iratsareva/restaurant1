# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Jenkins –≤ Docker –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞

## üê≥ –í–∞—Ä–∏–∞–Ω—Ç 1: Jenkins –≤ Docker Compose (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### –®–∞–≥ 1: –ó–∞–ø—É—Å–∫ Jenkins —á–µ—Ä–µ–∑ Docker Compose

Jenkins —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω –≤ `docker-compose.yml`. –ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:

```bash
docker-compose up -d jenkins
```

–ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã:

```bash
docker-compose up -d
```

Jenkins –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: **http://localhost:8080**

### –®–∞–≥ 2: –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Jenkins

1. **–û—Ç–∫—Ä–æ–π—Ç–µ Jenkins:**
   ```
   http://localhost:8080
   ```

2. **–ü–æ–ª—É—á–∏—Ç–µ –Ω–∞—á–∞–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å:**
   ```bash
   # –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
   docker-compose exec jenkins cat /var/jenkins_home/secrets/initialAdminPassword
   ```
   
   –ò–ª–∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏:
   ```bash
   docker-compose logs jenkins | grep -A 5 "Please use the following password"
   ```

3. **–í–æ–π–¥–∏—Ç–µ –≤ Jenkins:**
   - –í—Å—Ç–∞–≤—å—Ç–µ –ø–∞—Ä–æ–ª—å –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–∞–≥–∞
   - –ù–∞–∂–º–∏—Ç–µ "Continue"

4. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–ª–∞–≥–∏–Ω—ã:**
   - –í—ã–±–µ—Ä–∏—Ç–µ "Install suggested plugins"
   - –î–æ–∂–¥–∏—Ç–µ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ—Ö –ø–ª–∞–≥–∏–Ω–æ–≤

5. **–°–æ–∑–¥–∞–π—Ç–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:**
   - –£–∫–∞–∂–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `admin`)
   - –£–∫–∞–∂–∏—Ç–µ –ø–∞—Ä–æ–ª—å
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–ª–∞–≥–∏–Ω–æ–≤

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Manage Jenkins ‚Üí Manage Plugins**

2. –ù–∞ –≤–∫–ª–∞–¥–∫–µ **Available** —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
   - ‚úÖ **Pipeline** (–æ–±—ã—á–Ω–æ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
   - ‚úÖ **Docker Pipeline**
   - ‚úÖ **Git**
   - ‚úÖ **GitHub** (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ GitHub)
   - ‚úÖ **Maven Integration**
   - ‚úÖ **Blue Ocean** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ UI)

3. –ù–∞–∂–º–∏—Ç–µ **Install without restart**

4. –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞–∂–º–∏—Ç–µ **Restart Jenkins when installation is complete**

### –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Maven –≤ Jenkins

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Manage Jenkins ‚Üí Global Tool Configuration**

2. –í —Ä–∞–∑–¥–µ–ª–µ **Maven**:
   - –ù–∞–∂–º–∏—Ç–µ **Add Maven**
   - **Name**: `Maven 3.9` (–∏–ª–∏ –ª—é–±–æ–µ –∏–º—è)
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≥–∞–ª–æ—á–∫—É **Install automatically**
   - –í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ä—Å–∏—é: `3.9.6` (–∏–ª–∏ –ø–æ—Å–ª–µ–¥–Ω—é—é —Å—Ç–∞–±–∏–ª—å–Ω—É—é)
   - –ù–∞–∂–º–∏—Ç–µ **Save**

### –®–∞–≥ 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Docker –≤ Jenkins

Docker —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω —á–µ—Ä–µ–∑ volume mount –≤ docker-compose.yml:
- Docker socket –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è: `/var/run/docker.sock:/var/run/docker.sock`
- Docker binary –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è: `/usr/bin/docker:/usr/bin/docker`

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ Docker:**
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Manage Jenkins ‚Üí Script Console**
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ:
   ```groovy
   "docker --version".execute().text
   ```
3. –î–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –≤–µ—Ä—Å–∏—è Docker

### –®–∞–≥ 6: –°–æ–∑–¥–∞–Ω–∏–µ Pipeline Job

#### –í–∞—Ä–∏–∞–Ω—Ç A: Pipeline –∏–∑ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. **–°–æ–∑–¥–∞–π—Ç–µ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git remote add origin <your-repo-url>
   git push -u origin main
   ```

2. **–í Jenkins:**
   - –ù–∞–∂–º–∏—Ç–µ **New Item**
   - –ò–º—è: `restaurant-microservices`
   - –í—ã–±–µ—Ä–∏—Ç–µ **Pipeline**
   - –ù–∞–∂–º–∏—Ç–µ **OK**

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Pipeline:**
   - –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑ –¥–æ **Pipeline**
   - **Definition**: –≤—ã–±–µ—Ä–∏—Ç–µ **Pipeline script from SCM**
   - **SCM**: –≤—ã–±–µ—Ä–∏—Ç–µ **Git**
   - **Repository URL**: –≤—Å—Ç–∞–≤—å—Ç–µ URL –≤–∞—à–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
     - –ù–∞–ø—Ä–∏–º–µ—Ä: `https://github.com/yourusername/restaurant-project.git`
   - **Credentials**: –µ—Å–ª–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—Ä–∏–≤–∞—Ç–Ω—ã–π, –¥–æ–±–∞–≤—å—Ç–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   - **Branch Specifier**: `*/main` –∏–ª–∏ `*/master`
   - **Script Path**: `Jenkinsfile`
   - –ù–∞–∂–º–∏—Ç–µ **Save**

#### –í–∞—Ä–∏–∞–Ω—Ç B: Pipeline –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

1. **–í Jenkins:**
   - –ù–∞–∂–º–∏—Ç–µ **New Item**
   - –ò–º—è: `restaurant-microservices-local`
   - –í—ã–±–µ—Ä–∏—Ç–µ **Pipeline**
   - –ù–∞–∂–º–∏—Ç–µ **OK**

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Pipeline:**
   - –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑ –¥–æ **Pipeline**
   - **Definition**: –≤—ã–±–µ—Ä–∏—Ç–µ **Pipeline script**
   - –í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `Jenkinsfile` (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `@Library` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ —Ñ–∞–π–ª–∞)
   - –ù–∞–∂–º–∏—Ç–µ **Save**

### –®–∞–≥ 7: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ª–æ–∫–∞–ª—å–Ω—ã–º –ø—Ä–æ–µ–∫—Ç–æ–º

–ï—Å–ª–∏ –≤–∞—à –ø—Ä–æ–µ–∫—Ç –µ—â–µ –Ω–µ –≤ Git, –Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Ç–æ–º –∂–µ —Ö–æ—Å—Ç–µ:

1. **–û–±–Ω–æ–≤–∏—Ç–µ Jenkinsfile** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ª–æ–∫–∞–ª—å–Ω—ã–º –ø—É—Ç–µ–º:
   ```groovy
   pipeline {
       agent any
       stages {
           stage('Checkout') {
               steps {
                   echo '–ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç...'
                   // –ü—Ä–æ–µ–∫—Ç —É–∂–µ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –≤ /workspace —á–µ—Ä–µ–∑ volume
               }
           }
           // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ stages
       }
   }
   ```

2. **–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É:**
   –í Jenkinsfile –∏–∑–º–µ–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –ø—É—Ç–∏:
   ```groovy
   dir('/workspace') {
       sh 'mvn clean install'
   }
   ```

### –®–∞–≥ 8: –ó–∞–ø—É—Å–∫ Pipeline

1. –í Jenkins –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã–π Pipeline job
2. –ù–∞–∂–º–∏—Ç–µ **Build Now**
3. –°–ª–µ–¥–∏—Ç–µ –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –≤ **Console Output**

### –®–∞–≥ 9: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Pipeline:

- **Jenkins**: http://localhost:8080
- **Demo REST**: http://localhost:8080 (–µ—Å–ª–∏ –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç —Å Jenkins)
- **Prometheus**: http://localhost:9091
- **Grafana**: http://localhost:3000
- **Zipkin**: http://localhost:9411

## üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: Jenkins –Ω–µ –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å Docker –∫–æ–º–∞–Ω–¥—ã

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Docker socket –¥–æ—Å—Ç—É–ø–µ–Ω
docker-compose exec jenkins ls -la /var/run/docker.sock

# –ï—Å–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞, –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose restart jenkins
```

### –ü—Ä–æ–±–ª–µ–º–∞: Jenkins –Ω–µ –≤–∏–¥–∏—Ç –ø—Ä–æ–µ–∫—Ç

**–†–µ—à–µ–Ω–∏–µ:**
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ docker-compose.yml –µ—Å—Ç—å:
```yaml
volumes:
  - ./:/workspace
```

### –ü—Ä–æ–±–ª–µ–º–∞: Maven –Ω–µ –Ω–∞–π–¥–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
1. –í Jenkins: **Manage Jenkins ‚Üí Global Tool Configuration**
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Maven —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Maven Wrapper (`./mvnw`) –≤ –ø—Ä–æ–µ–∫—Ç–µ

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ—Ä—Ç 8080 –∑–∞–Ω—è—Ç

**–†–µ—à–µ–Ω–∏–µ:**
–ò–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç Jenkins –≤ docker-compose.yml:
```yaml
ports:
  - "8081:8080"  # Jenkins –±—É–¥–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 8081
```

–ò –æ–±–Ω–æ–≤–∏—Ç–µ –≤—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ Jenkins.

## üìù –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Jenkinsfile –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

–ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ (–Ω–µ –≤ Git), –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç:

```groovy
pipeline {
    agent any

    environment {
        PROJECT_DIR = '/workspace'
        DOCKER_COMPOSE = 'docker-compose'
    }

    stages {
        stage('Checkout') {
            steps {
                echo '–ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –∏–∑ /workspace...'
                sh 'ls -la ${PROJECT_DIR}'
            }
        }

        stage('Build events-contract') {
            steps {
                dir("${PROJECT_DIR}/events-contract") {
                    sh 'mvn clean install -DskipTests'
                }
            }
        }

        // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ stages –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ
    }
}
```

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- [ ] Jenkins –∑–∞–ø—É—â–µ–Ω —á–µ—Ä–µ–∑ `docker-compose up -d jenkins`
- [ ] –ü–æ–ª—É—á–µ–Ω –Ω–∞—á–∞–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–ª–∞–≥–∏–Ω—ã
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω Maven –≤ Global Tool Configuration
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω –¥–æ—Å—Ç—É–ø –∫ Docker –∏–∑ Jenkins
- [ ] –°–æ–∑–¥–∞–Ω Pipeline job
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Git (–∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—É—Ç—å)
- [ ] Pipeline —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—â–µ–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –ú–µ—Ç—Ä–∏–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ Prometheus –∏ Grafana

## üéØ –ò—Ç–æ–≥

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤:

‚úÖ Jenkins —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ  
‚úÖ Jenkins –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ Docker –¥–ª—è —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–æ–≤  
‚úÖ Jenkins –º–æ–∂–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å docker-compose  
‚úÖ Pipeline –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞–µ—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã  
‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ Grafana  

**–î–∞, –≤—ã —Å–º–æ–∂–µ—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ!** Jenkins –≤ Docker –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω –∏ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –≤–∞—à–∏–º –ø—Ä–æ–µ–∫—Ç–æ–º.

